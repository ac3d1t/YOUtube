<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeTube // Anti-Buns</title>
    <style>
        :root { --bg: #0a0a0a; --card-bg: #161616; --accent: #bc13fe; --text: #ffffff; --text-dim: #888; }
        body { background-color: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; }
        nav { display: flex; justify-content: space-between; padding: 1rem 2rem; background: rgba(15, 15, 15, 0.8); backdrop-filter: blur(12px); border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 100; }
        .logo { font-weight: 800; color: var(--accent); font-size: 1.5rem; }
        .feed-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; padding: 2rem; }
        .video-card { background: var(--card-bg); border-radius: 12px; overflow: hidden; border: 1px solid #222; cursor: pointer; transition: 0.2s; }
        .video-card:hover { transform: translateY(-3px); border-color: var(--accent); }
        .video-card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; }
        .video-info { padding: 12px; }
        .video-title { font-size: 0.95rem; font-weight: 600; margin: 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .status-msg { grid-column: 1/-1; text-align: center; color: var(--text-dim); padding: 20px; }
    </style>
</head>
<body>

    <nav>
        <div class="logo">VIBETUBE</div>
        <button onclick="loadFeed()">Refresh Feed</button>
    </nav>

    <div class="feed-container" id="main-feed">
        <div class="status-msg">Initiating vibe-check...</div>
    </div>

    <script>
        // LIST OF BACKUP INSTANCES
        const INSTANCES = [
            "https://pipedapi.kavin.rocks",
            "https://pipedapi.leptons.xyz",
            "https://pipedapi.nosebs.ru",
            "https://piped-api.privacy.com.de"
        ];

        async function loadFeed() {
            const feed = document.getElementById('main-feed');
            
            for (let baseUrl of INSTANCES) {
                try {
                    feed.innerHTML = `<div class="status-msg">Trying instance: ${baseUrl.split('//')[1]}...</div>`;
                    
                    const response = await fetch(`${baseUrl}/trending?region=US`);
                    if (!response.ok) throw new Error("Server error");
                    
                    const videos = await response.json();
                    renderVideos(videos);
                    return; // EXIT loop if successful!
                } catch (err) {
                    console.log(`${baseUrl} failed, trying next...`);
                }
            }
            feed.innerHTML = `<div class="status-msg" style="color:red">All instances are currently busy. Try again in 5 mins.</div>`;
        }

        function renderVideos(videos) {
            const feed = document.getElementById('main-feed');
            feed.innerHTML = ''; 
            
            videos.forEach(video => {
                if (video.duration < 60) return; // Nuke the Shorts

                const card = document.createElement('div');
                card.className = 'video-card';
                card.innerHTML = `
                    <img src="${video.thumbnail}" loading="lazy">
                    <div class="video-info">
                        <h3 class="video-title">${video.title}</h3>
                        <p style="font-size:0.8rem; color:#888">${video.uploaderName}</p>
                    </div>
                `;
                card.onclick = () => window.open(`https://piped.video${video.url}`, '_blank');
                feed.appendChild(card);
            });
        }

        loadFeed();
    </script>
</body>
</html>
